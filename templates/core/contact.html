{% extends 'base.html' %}
{% load static %}

{% block title %}Contact Us - {{ site_settings.site_name }}{% endblock %}

{% block meta_description %}Get in touch with {{ site_settings.site_name }}. We're here to help you start your tech journey. Contact us for inquiries, support, or custom solutions.{% endblock %}

{% block body_class %}contact-page{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header bg-gradient-primary text-white py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-3">
                        <li class="breadcrumb-item"><a href="{% url 'core:home' %}" class="text-white-50">Home</a></li>
                        <li class="breadcrumb-item active text-white" aria-current="page">Contact</li>
                    </ol>
                </nav>
                <h1 class="display-4 fw-bold mb-3" data-aos="fade-up">Get In Touch</h1>
                <p class="lead mb-0" data-aos="fade-up" data-aos-delay="100">
                    {% if contact_content %}
                        {{ contact_content.subtitle|default:"We're here to help you start your tech journey. Reach out to us for any inquiries, support, or custom solutions." }}
                    {% else %}
                        We're here to help you start your tech journey. Reach out to us for any inquiries, support, or custom solutions.
                    {% endif %}
                </p>
            </div>
            <div class="col-lg-4 text-lg-end" data-aos="fade-left" data-aos-delay="200">
                <div class="contact-stats">
                    <div class="stat-item mb-3">
                        <i class="fas fa-clock fa-2x mb-2"></i>
                        <div class="text-white">
                            <strong>Response Time</strong>
                            <div class="small">Within 24 hours</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section class="contact-section py-5">
    <div class="container">
        <div class="row">
            <!-- Contact Form -->
            <div class="col-lg-8 mb-5">
                <div class="contact-form-wrapper" data-aos="fade-up">
                    <div class="form-header mb-4">
                        <h2 class="h3 fw-bold mb-2">Send Us a Message</h2>
                        <p class="text-muted">Fill out the form below and we'll get back to you as soon as possible.</p>
                    </div>
                    
                    <form method="post" class="contact-form" id="contactForm">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="name" class="form-label">Full Name <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-user text-muted"></i>
                                    </span>
                                    <input type="text" 
                                           class="form-control" 
                                           id="name" 
                                           name="name" 
                                           required 
                                           placeholder="Enter your full name">
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="email" class="form-label">Email Address <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-envelope text-muted"></i>
                                    </span>
                                    <input type="email" 
                                           class="form-control" 
                                           id="email" 
                                           name="email" 
                                           required 
                                           placeholder="Enter your email address">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="phone" class="form-label">Phone Number</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-phone text-muted"></i>
                                    </span>
                                    <input type="tel" 
                                           class="form-control" 
                                           id="phone" 
                                           name="phone" 
                                           placeholder="Enter your phone number">
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="subject" class="form-label">Subject <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-tag text-muted"></i>
                                    </span>
                                    <select class="form-select" id="subject" name="subject" required>
                                        <option value="">Select a subject</option>
                                        {% for value, label in subject_choices %}
                                        <option value="{{ value }}">{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="message" class="form-label">Message <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text align-items-start pt-3">
                                    <i class="fas fa-comment text-muted"></i>
                                </span>
                                <textarea class="form-control" 
                                         id="message" 
                                         name="message" 
                                         rows="6" 
                                         required 
                                         placeholder="Tell us about your inquiry or how we can help you..."></textarea>
                            </div>
                            <div class="form-text">
                                <small class="text-muted">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Please provide as much detail as possible so we can assist you better.
                                </small>
                            </div>
                        </div>
                        
                        <div class="form-check mb-4">
                            <input class="form-check-input" type="checkbox" id="privacy" required>
                            <label class="form-check-label" for="privacy">
                                I agree to the <a href="{% url 'core:page_detail' slug='privacy' %}" target="_blank">Privacy Policy</a> and consent to my data being processed to respond to my inquiry. <span class="text-danger">*</span>
                            </label>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-paper-plane me-2"></i>
                            <span class="btn-text">Send Message</span>
                            <span class="btn-loading d-none">
                                <i class="fas fa-spinner fa-spin me-2"></i>Sending...
                            </span>
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- Contact Information -->
            <div class="col-lg-4">
                <div class="contact-info-wrapper" data-aos="fade-up" data-aos-delay="200">
                    <div class="contact-info-card">
                        <h3 class="h4 fw-bold mb-4">Contact Information</h3>
                        
                        {% if company_info %}
                        <!-- Address -->
                        {% if company_info.address %}
                        <div class="contact-item mb-4">
                            <div class="contact-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="contact-details">
                                <h6 class="fw-bold mb-1">Our Office</h6>
                                <p class="text-muted mb-0">{{ company_info.address }}</p>
                                {% if company_info.city and company_info.country %}
                                <p class="text-muted mb-0">{{ company_info.city }}, {{ company_info.country }}</p>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                        
                        <!-- Phone -->
                        {% if company_info.phone %}
                        <div class="contact-item mb-4">
                            <div class="contact-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="contact-details">
                                <h6 class="fw-bold mb-1">Call Us</h6>
                                <p class="text-muted mb-0">
                                    <a href="tel:{{ company_info.phone }}" class="text-decoration-none">
                                        {{ company_info.phone }}
                                    </a>
                                </p>
                                <small class="text-muted">Mon - Fri, 9:00 AM - 6:00 PM</small>
                            </div>
                        </div>
                        {% endif %}
                        
                        <!-- Email -->
                        {% if company_info.email %}
                        <div class="contact-item mb-4">
                            <div class="contact-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="contact-details">
                                <h6 class="fw-bold mb-1">Email Us</h6>
                                <p class="text-muted mb-0">
                                    <a href="mailto:{{ company_info.email }}" class="text-decoration-none">
                                        {{ company_info.email }}
                                    </a>
                                </p>
                                <small class="text-muted">We'll respond within 24 hours</small>
                            </div>
                        </div>
                        {% endif %}
                        
                        <!-- Website -->
                        {% if company_info.website %}
                        <div class="contact-item mb-4">
                            <div class="contact-icon">
                                <i class="fas fa-globe"></i>
                            </div>
                            <div class="contact-details">
                                <h6 class="fw-bold mb-1">Website</h6>
                                <p class="text-muted mb-0">
                                    <a href="{{ company_info.website }}" target="_blank" class="text-decoration-none">
                                        {{ company_info.website }}
                                    </a>
                                </p>
                            </div>
                        </div>
                        {% endif %}
                        {% endif %}
                        
                        <!-- Social Media -->
                        {% if social_links %}
                        <div class="contact-item">
                            <div class="contact-icon">
                                <i class="fas fa-share-alt"></i>
                            </div>
                            <div class="contact-details">
                                <h6 class="fw-bold mb-2">Follow Us</h6>
                                <div class="social-links">
                                    {% for social in social_links %}
                                    <a href="{{ social.url }}" 
                                       target="_blank" 
                                       class="social-link"
                                       title="{{ social.name }}">
                                        <i class="{{ social.icon }}"></i>
                                    </a>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Quick Contact Card -->
                    <div class="quick-contact-card mt-4">
                        <div class="card-header">
                            <h5 class="fw-bold mb-0">
                                <i class="fas fa-bolt text-warning me-2"></i>
                                Quick Contact
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="text-muted mb-3">Need immediate assistance? Choose your preferred method:</p>
                            <div class="quick-actions">
                                {% if company_info.phone %}
                                <a href="tel:{{ company_info.phone }}" class="btn btn-outline-primary btn-sm mb-2 w-100">
                                    <i class="fas fa-phone me-2"></i>Call Now
                                </a>
                                {% endif %}
                                {% if company_info.whatsapp %}
                                <a href="https://wa.me/{{ company_info.whatsapp }}" 
                                   target="_blank" 
                                   class="btn btn-outline-success btn-sm mb-2 w-100">
                                    <i class="fab fa-whatsapp me-2"></i>WhatsApp
                                </a>
                                {% endif %}
                                <a href="{% url 'core:services' %}" class="btn btn-outline-secondary btn-sm w-100">
                                    <i class="fas fa-graduation-cap me-2"></i>View Courses
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Map Section -->
{% if company_info.latitude and company_info.longitude %}
<section class="map-section py-5 bg-secondary">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center mb-4">
                <h2 class="h3 fw-bold mb-2" data-aos="fade-up">Find Us</h2>
                <p class="text-muted" data-aos="fade-up" data-aos-delay="100">
                    Visit our office for in-person consultations and training sessions.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="map-container" data-aos="fade-up" data-aos-delay="200">
                    <div id="map" style="height: 400px; border-radius: 15px; overflow: hidden;"></div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- FAQ Section -->
{% if faqs %}
<section class="faq-section py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto text-center mb-5">
                <h2 class="display-6 fw-bold mb-3" data-aos="fade-up">Frequently Asked Questions</h2>
                <p class="lead text-muted" data-aos="fade-up" data-aos-delay="100">
                    Find quick answers to common questions about our services and programs.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <div class="accordion" id="faqAccordion">
                    {% for faq in faqs %}
                    <div class="accordion-item" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:100 }}">
                        <h3 class="accordion-header" id="faq{{ forloop.counter }}">
                            <button class="accordion-button {% if not forloop.first %}collapsed{% endif %}" 
                                    type="button" 
                                    data-bs-toggle="collapse" 
                                    data-bs-target="#faqCollapse{{ forloop.counter }}" 
                                    aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}" 
                                    aria-controls="faqCollapse{{ forloop.counter }}">
                                <i class="fas fa-question-circle me-2 text-primary"></i>
                                {{ faq.question }}
                            </button>
                        </h3>
                        <div id="faqCollapse{{ forloop.counter }}" 
                             class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" 
                             aria-labelledby="faq{{ forloop.counter }}" 
                             data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                {{ faq.answer|safe }}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <div class="text-center mt-4">
                    <p class="text-muted mb-3">Still have questions?</p>
                    <a href="#contactForm" class="btn btn-primary smooth-scroll">
                        <i class="fas fa-comments me-2"></i>Ask Us Anything
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Office Hours & Support -->
<section class="support-section py-5 bg-secondary">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 mb-4">
                <div class="support-card" data-aos="fade-up">
                    <div class="support-icon mb-3">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h5 class="fw-bold mb-3">Office Hours</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <strong>Monday - Friday:</strong><br>
                            <span class="text-muted">9:00 AM - 6:00 PM</span>
                        </li>
                        <li class="mb-2">
                            <strong>Saturday:</strong><br>
                            <span class="text-muted">9:00 AM - 2:00 PM</span>
                        </li>
                        <li>
                            <strong>Sunday:</strong><br>
                            <span class="text-muted">Closed</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-4 mb-4">
                <div class="support-card" data-aos="fade-up" data-aos-delay="200">
                    <div class="support-icon mb-3">
                        <i class="fas fa-headset"></i>
                    </div>
                    <h5 class="fw-bold mb-3">24/7 Support</h5>
                    <p class="text-muted mb-3">
                        Get help anytime through our online support portal and community forums.
                    </p>
                    <a href="#" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-external-link-alt me-2"></i>Access Support
                    </a>
                </div>
            </div>
            <div class="col-lg-4 mb-4">
                <div class="support-card" data-aos="fade-up" data-aos-delay="400">
                    <div class="support-icon mb-3">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <h5 class="fw-bold mb-3">Book a Meeting</h5>
                    <p class="text-muted mb-3">
                        Schedule a one-on-one consultation with our education consultants.
                    </p>
                    <a href="#" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-calendar me-2"></i>Schedule Now
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
/* Contact Form Styling */
.contact-form-wrapper {
    background: var(--bg-card);
    padding: 2.5rem;
    border-radius: var(--border-radius-xl);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-color);
}

.input-group {
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
}

.input-group-text {
    background: var(--bg-secondary);
    border: none;
    color: var(--text-secondary);
}

.form-control, .form-select {
    border: none;
    border-left: 1px solid var(--border-color);
    padding: 0.75rem 1rem;
}

.form-control:focus, .form-select:focus {
    box-shadow: none;
    border-color: var(--primary-color);
}

.input-group:focus-within {
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

/* Contact Info Card */
.contact-info-card {
    background: var(--bg-card);
    padding: 2rem;
    border-radius: var(--border-radius-xl);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-color);
    height: fit-content;
}

.contact-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.contact-icon {
    width: 45px;
    height: 45px;
    background: var(--gradient-primary);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1rem;
    flex-shrink: 0;
}

.contact-details h6 {
    color: var(--text-primary);
}

.contact-details a {
    color: var(--text-secondary);
    transition: color 0.3s ease;
}

.contact-details a:hover {
    color: var(--primary-color);
}

/* Social Links */
.social-links {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.social-link {
    width: 40px;
    height: 40px;
    background: var(--bg-secondary);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary);
    text-decoration: none;
    transition: all 0.3s ease;
}

.social-link:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
}

/* Quick Contact Card */
.quick-contact-card {
    background: var(--bg-card);
    border-radius: var(--border-radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-color);
}

.quick-contact-card .card-header {
    background: var(--gradient-primary);
    color: white;
    padding: 1rem 1.5rem;
    border: none;
}

.quick-contact-card .card-body {
    padding: 1.5rem;
}

/* Support Cards */
.support-card {
    background: var(--bg-card);
    padding: 2rem;
    border-radius: var(--border-radius-xl);
    text-align: center;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-color);
    height: 100%;
    transition: all 0.3s ease;
}

.support-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-md);
}

.support-icon {
    width: 60px;
    height: 60px;
    background: var(--gradient-primary);
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    color: white;
    font-size: 1.5rem;
}

/* FAQ Accordion */
.accordion-item {
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-lg) !important;
    margin-bottom: 1rem;
    overflow: hidden;
}

.accordion-button {
    background: var(--bg-card);
    border: none;
    color: var(--text-primary);
    font-weight: 600;
    padding: 1.25rem 1.5rem;
}

.accordion-button:not(.collapsed) {
    background: var(--gradient-primary);
    color: white;
    box-shadow: none;
}

.accordion-button:focus {
    box-shadow: none;
    border: none;
}

.accordion-button::after {
    background-image: none;
    content: '\f078';
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
    font-size: 0.875rem;
}

.accordion-button:not(.collapsed)::after {
    transform: rotate(180deg);
    color: white;
}

.accordion-body {
    padding: 1.5rem;
    background: var(--bg-card);
    border-top: 1px solid var(--border-color);
}

/* Map Container */
.map-container {
    position: relative;
    overflow: hidden;
    border-radius: 15px;
    box-shadow: var(--shadow-lg);
}

/* Form Validation Styles */
.form-control.is-valid, .form-select.is-valid {
    border-color: var(--success-color);
}

.form-control.is-invalid, .form-select.is-invalid {
    border-color: var(--error-color);
}

.invalid-feedback {
    display: block;
    color: var(--error-color);
    font-size: 0.875rem;
    margin-top: 0.25rem;
}

.valid-feedback {
    display: block;
    color: var(--success-color);
    font-size: 0.875rem;
    margin-top: 0.25rem;
}

/* Responsive Design */
@media (max-width: 768px) {
    .contact-form-wrapper {
        padding: 1.5rem;
        margin-bottom: 2rem;
    }
    
    .contact-info-card {
        padding: 1.5rem;
    }
    
    .contact-item {
        flex-direction: column;
        text-align: center;
        margin-bottom: 2rem;
    }
    
    .support-card {
        margin-bottom: 2rem;
    }
    
    .quick-actions .btn {
        margin-bottom: 0.5rem;
    }
    
    .page-header .col-lg-4 {
        text-align: center;
        margin-top: 2rem;
    }
}

/* Page Transitions */
.contact-form-wrapper,
.contact-info-card,
.support-card {
    transition: all 0.3s ease;
}

/* Hover Effects */
.contact-item:hover .contact-icon {
    transform: scale(1.05);
    box-shadow: var(--shadow-md);
}

.support-card:hover .support-icon {
    transform: scale(1.1) rotate(5deg);
}

/* Accessibility Improvements */
.form-control:focus,
.form-select:focus,
.btn:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
}

.accordion-button:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: -2px;
}

/* Animation Classes */
.fade-in {
    animation: fadeIn 0.6s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.slide-up {
    animation: slideUp 0.6s ease-in-out;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Success/Error Message Styling */
.alert-success {
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid var(--success-color);
    color: var(--success-color);
    border-radius: var(--border-radius);
}

.alert-danger {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid var(--error-color);
    color: var(--error-color);
    border-radius: var(--border-radius);
}

/* Custom Scrollbar for FAQ */
.accordion-body::-webkit-scrollbar {
    width: 6px;
}

.accordion-body::-webkit-scrollbar-track {
    background: var(--bg-secondary);
    border-radius: 3px;
}

.accordion-body::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 3px;
}

.accordion-body::-webkit-scrollbar-thumb:hover {
    background: var(--primary-dark);
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Form handling
    const contactForm = document.getElementById('contactForm');
    const submitBtn = contactForm.querySelector('button[type="submit"]');
    const btnText = submitBtn.querySelector('.btn-text');
    const btnLoading = submitBtn.querySelector('.btn-loading');
    
    // Form validation
    function validateForm() {
        let isValid = true;
        const requiredFields = contactForm.querySelectorAll('[required]');
        
        requiredFields.forEach(field => {
            const value = field.value.trim();
            const fieldGroup = field.closest('.mb-3') || field.closest('.mb-4');
            
            // Remove existing feedback
            const existingFeedback = fieldGroup.querySelector('.invalid-feedback');
            if (existingFeedback) {
                existingFeedback.remove();
            }
            
            field.classList.remove('is-invalid', 'is-valid');
            
            if (!value) {
                field.classList.add('is-invalid');
                showFieldError(field, 'This field is required.');
                isValid = false;
            } else if (field.type === 'email' && !isValidEmail(value)) {
                field.classList.add('is-invalid');
                showFieldError(field, 'Please enter a valid email address.');
                isValid = false;
            } else {
                field.classList.add('is-valid');
            }
        });
        
        return isValid;
    }
    
    function showFieldError(field, message) {
        const fieldGroup = field.closest('.mb-3') || field.closest('.mb-4');
        const feedback = document.createElement('div');
        feedback.className = 'invalid-feedback';
        feedback.textContent = message;
        fieldGroup.appendChild(feedback);
    }
    
    function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }
    
    // Real-time validation
    const formInputs = contactForm.querySelectorAll('input, select, textarea');
    formInputs.forEach(input => {
        input.addEventListener('blur', function() {
            if (this.hasAttribute('required')) {
                const value = this.value.trim();
                const fieldGroup = this.closest('.mb-3') || this.closest('.mb-4');
                const existingFeedback = fieldGroup.querySelector('.invalid-feedback');
                
                if (existingFeedback) {
                    existingFeedback.remove();
                }
                
                this.classList.remove('is-invalid', 'is-valid');
                
                if (!value) {
                    this.classList.add('is-invalid');
                    showFieldError(this, 'This field is required.');
                } else if (this.type === 'email' && !isValidEmail(value)) {
                    this.classList.add('is-invalid');
                    showFieldError(this, 'Please enter a valid email address.');
                } else {
                    this.classList.add('is-valid');
                }
            }
        });
        
        // Character counter for message field
        if (input.name === 'message') {
            const counter = document.createElement('div');
            counter.className = 'form-text text-end';
            counter.innerHTML = '<small class="text-muted"><span id="charCount">0</span>/500 characters</small>';
            input.parentNode.insertBefore(counter, input.nextSibling);
            
            input.addEventListener('input', function() {
                const charCount = document.getElementById('charCount');
                const length = this.value.length;
                charCount.textContent = length;
                
                if (length > 450) {
                    charCount.parentNode.classList.add('text-warning');
                } else {
                    charCount.parentNode.classList.remove('text-warning');
                }
            });
        }
    });
    
    // Form submission
    contactForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (!validateForm()) {
            return;
        }
        
        // Show loading state
        submitBtn.classList.add('loading');
        btnText.classList.add('d-none');
        btnLoading.classList.remove('d-none');
        
        // Simulate form submission (replace with actual form submission)
        setTimeout(() => {
            // Reset loading state
            submitBtn.classList.remove('loading');
            btnText.classList.remove('d-none');
            btnLoading.classList.add('d-none');
            
            // Show success message
            showSuccessMessage();
            
            // Reset form
            contactForm.reset();
            formInputs.forEach(input => {
                input.classList.remove('is-valid', 'is-invalid');
            });
            
            // Remove any existing feedback
            const feedbacks = contactForm.querySelectorAll('.invalid-feedback, .valid-feedback');
            feedbacks.forEach(feedback => feedback.remove());
            
        }, 2000);
        
        // Actual form submission would be:
        // const formData = new FormData(this);
        // fetch(this.action, {
        //     method: 'POST',
        //     body: formData,
        //     headers: {
        //         'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        //     }
        // })
        // .then(response => response.json())
        // .then(data => {
        //     // Handle response
        // })
        // .catch(error => {
        //     // Handle error
        // });
    });
    
    function showSuccessMessage() {
        const alert = document.createElement('div');
        alert.className = 'alert alert-success alert-dismissible fade show';
        alert.innerHTML = `
            <i class="fas fa-check-circle me-2"></i>
            <strong>Message sent successfully!</strong> We'll get back to you within 24 hours.
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        
        contactForm.insertBefore(alert, contactForm.firstChild);
        
        // Auto-dismiss after 5 seconds
        setTimeout(() => {
            if (alert.parentNode) {
                alert.remove();
            }
        }, 5000);
    }
    
    // Smooth scrolling for internal links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // FAQ accordion enhancements
    const accordionButtons = document.querySelectorAll('.accordion-button');
    accordionButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Add smooth transition
            const target = document.querySelector(this.getAttribute('data-bs-target'));
            if (target) {
                setTimeout(() => {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'nearest'
                    });
                }, 300);
            }
        });
    });
    
    // Contact info hover effects
    const contactItems = document.querySelectorAll('.contact-item');
    contactItems.forEach(item => {
        item.addEventListener('mouseenter', function() {
            this.style.transform = 'translateX(5px)';
            this.style.transition = 'transform 0.3s ease';
        });
        
        item.addEventListener('mouseleave', function() {
            this.style.transform = 'translateX(0)';
        });
    });
    
    // Social link animations
    const socialLinks = document.querySelectorAll('.social-link');
    socialLinks.forEach(link => {
        link.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-3px) scale(1.05)';
        });
        
        link.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
    
    // Auto-resize textarea
    const textareas = document.querySelectorAll('textarea');
    textareas.forEach(textarea => {
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight + 'px';
        });
    });
    
    // Initialize map if coordinates are available
    {% if company_info.latitude and company_info.longitude %}
    initializeMap();
    {% endif %}
});

// Map initialization function
{% if company_info.latitude and company_info.longitude %}
function initializeMap() {
    // This is a placeholder for map initialization
    // You would typically use Google Maps, Mapbox, or similar service
    const mapContainer = document.getElementById('map');
    if (mapContainer) {
        mapContainer.innerHTML = `
            <div class="d-flex align-items-center justify-content-center h-100 bg-secondary text-white">
                <div class="text-center">
                    <i class="fas fa-map-marker-alt fa-3x mb-3"></i>
                    <h5>Our Location</h5>
                    <p class="mb-0">{{ company_info.address }}</p>
                    <a href="https://maps.google.com/?q={{ company_info.latitude }},{{ company_info.longitude }}" 
                       target="_blank" 
                       class="btn btn-light btn-sm mt-3">
                        <i class="fas fa-external-link-alt me-2"></i>Open in Google Maps
                    </a>
                </div>
            </div>
        `;
    }
}
{% endif %}

// Utility functions
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Performance optimization for scroll events
const throttledScrollHandler = debounce(() => {
    // Handle scroll-based animations
}, 16);

window.addEventListener('scroll', throttledScrollHandler);

// Copy to clipboard functionality
function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
            showToast('Copied to clipboard!', 'success');
        });
    } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showToast('Copied to clipboard!', 'success');
    }
}

// Toast notification function
function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `alert alert-${type} position-fixed top-0 end-0 m-3`;
    toast.style.zIndex = '9999';
    toast.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check' : 'info'}-circle me-2"></i>
        ${message}
    `;
    
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 3000);
}
</script>
{% endblock %} Animations */
.contact-form .form-control:focus,
.contact-form .form-select:focus {
    transform: translateY(-1px);
}

.btn {
    position: relative;
    overflow: hidden;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s ease;
}

.btn:hover::before {
    left: 100%;
}

/* Loading States */
.btn.loading {
    pointer-events: none;
    opacity: 0.8;
}

.btn.loading .btn-text {
    display: none;
}

.btn.loading .btn-loading {
    display: inline-block !important;
}

/* Form